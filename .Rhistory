Stu_Tw_Exchange_Concise$iso_a3[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)] <-
c("CHN","CHN","KOR","KOR","DEU","AUS","THA","ESP","SGP","NLD","CZE","AUT","RUS","SWE","PHL","BEL",
"VNM","IDN","ITA","FIN","POL","TUR","IND","DNK","LTU","NOR","IRL","KHM","EGY","SVK","HUN","MEX")
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange_Concise,iso_a3)%>%
summarise(Tot_Stu = sum(Tot_Stu,na.rm = T))%>%
arrange(desc(Tot_Stu))
Stu_Tw_Exchange_Concise <- inner_join(Stu_Tw_Exchange_Concise, Country_Name_2, by="iso_a3")
View(Stu_Tw_Exchange_Concise)
Stu_Tw_Exchange_Concise <- inner_join(Stu_Tw_Exchange_Concise, Country_Name_2, by="iso_a3")
Stu_Tw_Exchange_Concise_2 <- Stu_Tw_Exchange_Concise[,-c(1,4,5,6,7,8,9)]
View(Stu_Tw_Exchange_Concise_2)
Top_10_Stu_Tw_to_Change <- head(Stu_Tw_Exchange_Concise_2,10)
View(Top_10_Stu_Tw_to_Change)
Stu_Tw_Exchange <- Student_RPT_07
###統計台灣學生到各國家進修的人數
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange, `對方學校(機構)國別(地區)`) %>%
summarise(Tot_Stu = sum(as.numeric(`本國學生出國進修、交流人數`))) %>%
arrange(desc(Tot_Stu))
colnames(Stu_Tw_Exchange_Concise)[1] <- "國別"
Stu_Tw_Exchange_Concise <- full_join(Stu_Tw_Exchange_Concise, Country_Name_2, by = "國別")
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[!is.na(Stu_Tw_Exchange_Concise$Tot_Stu),]
index <- Stu_Tw_Exchange_Concise$國別[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)]
library(dplyr)
Stu_Tw_Exchange_Concise <- filter(Stu_Tw_Exchange_Concise, Tot_Stu > 15)
View(Stu_Tw_Exchange_Concise)
Stu_Tw_Exchange_Concise$iso_a3[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)] <-
c("CHN","CHN","KOR","KOR","DEU","AUS","THA","ESP","SGP","NLD","CZE","AUT","RUS","SWE","PHL","BEL",
"VNM","IDN","ITA","FIN","POL","TUR","IND","DNK","LTU","NOR","IRL","KHM","EGY","SVK","HUN","MEX")
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange_Concise,iso_a3)%>%
summarise(Tot_Stu = sum(Tot_Stu,na.rm = T))%>%
arrange(desc(Tot_Stu))
View(Stu_Tw_Exchange_Concise)
###選出Student_RPT_07中，台灣學生到外國進修的資料，另存成Stu_Tw_Exchange。
Stu_Tw_Exchange <- Student_RPT_07
###統計台灣學生到各國家進修的人數
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange, `對方學校(機構)國別(地區)`) %>%
summarise(Tot_Stu = sum(as.numeric(`本國學生出國進修、交流人數`))) %>%
arrange(desc(Tot_Stu))
colnames(Stu_Tw_Exchange_Concise)[1] <- "國別"
Stu_Tw_Exchange_Concise <- full_join(Stu_Tw_Exchange_Concise, Country_Name_2, by = "國別")
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[!is.na(Stu_Tw_Exchange_Concise$Tot_Stu),]
index <- Stu_Tw_Exchange_Concise$國別[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)]
library(dplyr)
Stu_Tw_Exchange_Concise <- filter(Stu_Tw_Exchange_Concise, Tot_Stu > 15)
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[-7,]
Stu_Tw_Exchange_Concise$iso_a3[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)] <-
c("CHN","CHN","KOR","KOR","DEU","AUS","THA","ESP","SGP","NLD","CZE","AUT","RUS","SWE","PHL","BEL",
"VNM","IDN","ITA","FIN","POL","TUR","IND","DNK","LTU","NOR","IRL","KHM","EGY","SVK","HUN","MEX")
Stu_Tw_Exchange <- Student_RPT_07
###統計台灣學生到各國家進修的人數
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange, `對方學校(機構)國別(地區)`) %>%
summarise(Tot_Stu = sum(as.numeric(`本國學生出國進修、交流人數`))) %>%
arrange(desc(Tot_Stu))
colnames(Stu_Tw_Exchange_Concise)[1] <- "國別"
Stu_Tw_Exchange_Concise <- full_join(Stu_Tw_Exchange_Concise, Country_Name_2, by = "國別")
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[!is.na(Stu_Tw_Exchange_Concise$Tot_Stu),]
index <- Stu_Tw_Exchange_Concise$國別[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)]
library(dplyr)
Stu_Tw_Exchange_Concise <- filter(Stu_Tw_Exchange_Concise, Tot_Stu > 15)
View(Stu_Tw_Exchange_Concise)
Stu_Tw_Exchange_Concise$iso_a3[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)] <-
c("CHN","CHN","KOR","KOR","DEU","AUS","THA","ESP","SGP","NLD","CZE","AUT","RUS","SWE","PHL","BEL",
"VNM","IDN","ITA","FIN","POL","TUR","IND","DNK","LTU","NOR","IRL","KHM","EGY","SVK","HUN","MEX")
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[-7,]
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange_Concise,iso_a3)%>%
summarise(Tot_Stu = sum(Tot_Stu,na.rm = T))%>%
arrange(desc(Tot_Stu))
Stu_Tw_Exchange_Concise <- inner_join(Stu_Tw_Exchange_Concise, Country_Name_2, by="iso_a3")
Stu_Tw_Exchange_Concise_2 <- Stu_Tw_Exchange_Concise[,-c(1,4,5,6,7,8,9)]
Top_10_Stu_Tw_to_Change <- head(Stu_Tw_Exchange_Concise_2,10)
knitr::kable(Top_10_Stu_Tw_to_Change)
Stu_Tw_Exchange_Concise_bar <- Stu_Tw_Exchange_Concise[,c(2,3)]
Sch_Stu_Abroad <- group_by(Stu_Tw_Exchange, 學校名稱)%>%
summarise(Tot_Stu = sum(as.numeric(`本國學生出國進修、交流人數`)))%>%
arrange(desc(Tot_Stu))
Top_10_Sch_Stu_Abroad <- head(Sch_Stu_Abroad,10)
knitr::kable(Top_10_Sch_Stu_Abroad)
Stu_Tw_Exchange_Concise_bar <- Stu_Tw_Exchange_Concise[,c(2,3)]
Stu_Tw_Exchange_Concise_bar$國別 <- factor(Stu_Tw_Exchange_Concise_bar$國別, levels = Stu_Tw_Exchange_Concise_bar$國別[order(desc(Stu_Tw_Exchange_Concise_bar))])
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise, aes(x = 國別, y = Tot_Stu),stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
---
title: "106-2 大數據分析方法 作業二"
output: github_document
author: 林辰建
---
作業完整說明[連結](https://docs.google.com/document/d/1aLGSsGXhgOVgwzSg9JdaNz2qGPQJSoupDAQownkGf_I/edit?usp=sharing)
學習再也不限定在自己出生的國家，台灣每年有許多學生選擇就讀國外的大專院校，同時也有人多國外的學生來台灣就讀，透過分析[大專校院境外學生人數統計](https://data.gov.tw/dataset/6289)、[大專校院本國學生出國進修交流數](https://data.gov.tw/dataset/24730)、[世界各主要國家之我國留學生人數統計表](https://ws.moe.edu.tw/Download.ashx?u=C099358C81D4876CC7586B178A6BD6D5062C39FB76BDE7EC7685C1A3C0846BCDD2B4F4C2FE907C3E7E96F97D24487065577A728C59D4D9A4ECDFF432EA5A114C8B01E4AFECC637696DE4DAECA03BB417&n=4E402A02CE6F0B6C1B3C7E89FDA1FAD0B5DDFA6F3DA74E2DA06AE927F09433CFBC07A1910C169A1845D8EB78BD7D60D7414F74617F2A6B71DC86D17C9DA3781394EF5794EEA7363C&icon=..csv)可以了解103年以後各大專院校國際交流的情形。請同學分析以下議題，並以視覺化的方式呈現分析結果，呈現103年以後大專院校國際交流的情形。
## 來台境外生分析
### 資料匯入與處理
```{r dataloadToTWN, message=FALSE, warning=FALSE}
library(readr)
###匯入103、104、105、106年間，外國留學生相關資訊。
###data_xxx_FStu_Country代表在民國xxx年間，各國來台留學生資訊。
###data_xxx_FStu_School代表在民國xxx年間，台灣各大專院校的外籍留學生資訊。
data_103_FStu_Country <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=25f64d5125016dcd6aed42e50c972ed0")
data_103_FStu_School <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=a6d1469f39fe41fb81dbfc373aef3331")
data_104_FStu_Country <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=4d3e9b37b7b0fd3aa18a388cdbc77996")
data_104_FStu_School <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=8baeae81cba74f35cf0bb1333d3d99f5")
data_105_FStu_Country <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=19bedf88cf46999da12513de755c33c6")
data_105_FStu_School <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=1a485383cf9995da679c3798ab4fd681")
data_106_FStu_Country <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=50e3370f9f8794f2054c0c82a2ed8c91")
data_106_FStu_School <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=883e2ab4d5357f70bea9ac44a47d05cc")
library(dplyr)
###將103中，各學程的外籍學生人數加總，並另存於新欄位FStudent_103。
data_103_FStu_Country <- mutate(data_103_FStu_Country, FStudent_103 = `學位生-正式修讀學位外國生`+ `學位生-僑生(含港澳)`+
`學位生-正式修讀學位陸生`+ `非學位生-外國交換生`+ `非學位生-外國短期研習及個人選讀`+ `非學位生-大專附設華語文中心學生`+
`非學位生-大陸研修生`+ `非學位生-海青班`+ 境外專班)
###將104中，各學程的外籍學生人數加總，並另存於新欄位FStudent_104。
data_104_FStu_Country <- mutate(data_104_FStu_Country, FStudent_104 = `學位生-正式修讀學位外國生`+ `學位生-僑生(含港澳)`+
`學位生-正式修讀學位陸生`+ `非學位生-外國交換生`+ `非學位生-外國短期研習及個人選讀`+ `非學位生-大專附設華語文中心學生`+
`非學位生-大陸研修生`+ `非學位生-海青班`+ 境外專班)
###將105中，各學程的外籍學生人數加總，並另存於新欄位FStudent_105。
data_105_FStu_Country <- mutate(data_105_FStu_Country, FStudent_105 = 學位生_正式修讀學位外國生+ `學位生_僑生(含港澳)`+
學位生_正式修讀學位陸生+ 非學位生_外國交換生+ 非學位生_外國短期研習及個人選讀+ 非學位生_大專附設華語文中心學生+
非學位生_大陸研修生+ 非學位生_海青班+ 境外專班)
###將106中，各學程的外籍學生人數加總，並另存於新欄位FStudent_106。
data_106_FStu_Country <- mutate(data_106_FStu_Country, FStudent_106 = 學位生_正式修讀學位外國生+ `學位生_僑生(含港澳)`+
學位生_正式修讀學位陸生+ 非學位生_外國交換生+ 非學位生_外國短期研習及個人選讀+ 非學位生_大專附設華語文中心學生+
非學位生_大陸研修生+ 非學位生_海青班+ 境外專班)
###將103、104、105、106年的資料依照'國別'合併，並另存成新的資料框Total。
Total <- full_join(data_103_FStu_Country, data_104_FStu_Country, by = '國別')
Total <- full_join(Total, data_105_FStu_Country, by = '國別')
Total <- full_join(Total, data_106_FStu_Country, by = '國別')
Total[is.na(Total)] <- as.numeric(0)
```
### 哪些國家來台灣唸書的學生最多呢？
```{r ToTWNCountry, message=FALSE, warning=FALSE}
###將Total資料框中103、104、105、106年間的留學生人數加總後另存成新欄位Total_FStudent，在依照Total_FStudent由大到小排列。
Total <- mutate(Total, Total_FStudent = FStudent_103+ FStudent_104+ FStudent_105+ FStudent_106,)%>%
arrange(desc(Total_FStudent))
###將Total資料框中，在台留學生人數少於200的國家合併，另存成"其他"，並將不需要的資訊刪除，另存於新的資料框Total_Concise。
Else <- filter(Total,Total_FStudent<200)%>%summarise(Else_Total = sum(Total_FStudent))
Total_Concise <- Total[,c(2,46)]%>%filter(Total_FStudent>= 200)%>% rbind(c("其他",Else$Else_Total))
Total_Concise$Total_FStudent <- as.numeric(Total_Concise$Total_FStudent)
TOP_10_Country <- head(Total_Concise,10)
knitr::kable(TOP_10_Country)
```
### 哪間大學的境外生最多呢？
```{r ToTWNUniversity, message=FALSE, warning=FALSE}
###資料中的"…"轉為0。
data_103_FStu_School$`非學位生-大陸研修生`[grepl("…", data_103_FStu_School$`非學位生-大陸研修生`)] <- 0
data_104_FStu_School$`非學位生-大陸研修生`[grepl("…", data_104_FStu_School$`非學位生-大陸研修生`)] <- 0
data_103_FStu_School$`非學位生-大陸研修生` <- as.numeric(data_103_FStu_School$`非學位生-大陸研修生`)
data_104_FStu_School$`非學位生-大陸研修生` <- as.numeric(data_104_FStu_School$`非學位生-大陸研修生`)
###將103中，各大專院校中，不同學程的外籍學生人數加總，並另存於新欄位FStudent_103。
data_103_FStu_School <-mutate(data_103_FStu_School, FStudent_103 = `學位生-正式修讀學位外國生`+ `學位生-僑生(含港澳)`+
`學位生-正式修讀學位陸生`+ `非學位生-外國交換生`+ `非學位生-外國短期研習及個人選讀`+ `非學位生-大專附設華語文中心學生`+
`非學位生-大陸研修生`+ `非學位生-海青班`+ 境外專班)
###將104中，各大專院校中，不同學程的外籍學生人數加總，並另存於新欄位FStudent_104。
data_104_FStu_School <- mutate(data_104_FStu_School, FStudent_104 = `學位生-正式修讀學位外國生`+ `學位生-僑生(含港澳)`+
`學位生-正式修讀學位陸生`+ `非學位生-外國交換生`+ `非學位生-外國短期研習及個人選讀`+ `非學位生-大專附設華語文中心學生`+
`非學位生-大陸研修生`+ `非學位生-海青班`+ 境外專班)
###將105中，各大專院校中，不同學程的外籍學生人數加總，並另存於新欄位FStudent_105。
data_105_FStu_School <- mutate(data_105_FStu_School, FStudent_105 = 學位生_正式修讀學位外國生+ `學位生_僑生(含港澳)`+
學位生_正式修讀學位陸生+ 非學位生_外國交換生+ 非學位生_外國短期研習及個人選讀+ 非學位生_大專附設華語文中心學生+
非學位生_大陸研修生+ 非學位生_海青班+ 境外專班)
###將106中，各大專院校中，不同學程的外籍學生人數加總，並另存於新欄位FStudent_106。
data_106_FStu_School <- mutate(data_106_FStu_School, FStudent_106 = 學位生_正式修讀學位外國生+ `學位生_僑生(含港澳)`+
學位生_正式修讀學位陸生+ 非學位生_外國交換生+ 非學位生_外國短期研習及個人選讀+ 非學位生_大專附設華語文中心學生+
非學位生_大陸研修生+ 非學位生_海青班+ 境外專班)
###將103、104、105、106年的資料依照'學校名稱'合併，並另存成新的資料框Total_2。
Total_2 <- full_join(data_103_FStu_School, data_104_FStu_School, by = '學校名稱')
Total_2 <- full_join(Total_2, data_105_FStu_School, by = '學校名稱')
Total_2 <- full_join(Total_2, data_106_FStu_School, by = '學校名稱')
Total_2[is.na(Total_2)] <- as.numeric(0)
###將Total_2資料框中103、104、105、106年間，各大專院校的的留學生人數加總後另存成新欄位Total_FStudent，在依照Total_FStudent由大到小排列。
Total_2 <- mutate(Total_2, Total_FStudent = FStudent_103+ FStudent_104+ FStudent_105+ FStudent_106)
###將Total_2資料框中，外籍留學生人數少於200的大專院校合併，另存成"其他"，並將不需要的資訊刪除，另存於新的資料框Total_Concise。
Else <- filter(Total_2,Total_FStudent<200)%>%summarise(Else_Total = sum(Total_FStudent))
Total_2_Concise <- Total_2[,c(3,50)]%>%filter(Total_FStudent>= 200)%>% rbind(c("其他",Else$Else_Total))
Total_2_Concise$Total_FStudent <- as.numeric(Total_2_Concise$Total_FStudent)
Total_2_Concise <- arrange(Total_2_Concise, desc(Total_FStudent))
TOP_10_School <- head(Total_2_Concise,10)
knitr::kable(TOP_10_School)
```
表格中，境外生最多的列為**無法區分校別**。他們為**非學位的大陸研究生**，在資料中被歸類為**無法區分校別**。
```{r ToTWNUniversity_1, message=FALSE, warning=FALSE}
Total_2_Concise_2 <- Total_2_Concise[-1,]
TOP_10_School_2 <- head(Total_2_Concise_2,10)
knitr::kable(TOP_10_School_2)
```
若忽略**無法區分校別**的部分，歷年來境外生最多的學校為**國立臺灣師範大學**
### 各個國家來台灣唸書的學生人數條狀圖
```{r ToTWNCountryBar, message=FALSE, warning=FALSE}
library(ggplot2)
Total_Concise$國別 <- factor(Total_Concise$國別, levels = Total_Concise$國別[order(desc(Total_Concise$Total_FStudent))])
ggplot()+ geom_bar(data = Total_Concise, aes(x = 國別, y = Total_FStudent), stat = "identity", width = 1, color="blue")+
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 6)) +
labs(y = "人數", title = "103到106年間各國來臺學生數量柱狀圖")
```
### 各個國家來台灣唸書的學生人數面量圖
```{r ToTWNCountryMap, message=FALSE, warning=FALSE}
###載入國含有各國國家代碼的資料。
Country_Name_2  <- read_csv("Country_Table.csv", locale = locale(encoding = "BIG5"))
colnames(Country_Name_2)[4] <- "iso_a3"
colnames(Country_Name_2)[1] <- "國別"
##將含有各國歷年來台留學生的資料(Total)與有各國國家代碼的資料合併，並另存為新的資料框Total_1_2。
Total_1_2 <- full_join(Total, Country_Name_2, by = "國別")
##將合併時遺漏的國家代碼的國家補上國家代碼。
index <- grep("[A-Z]{3}",Total_1_2$iso_a3,invert=T)
Total_1_2$iso_a3[index] <- c("VCT","KNA","TUV","MHL","XKS","SSD","MLT","COM")
##整理資料框Total_1_2
Total_1_2<-group_by(Total_1_2,iso_a3)%>%
summarise(Total_FStudent = sum(Total_FStudent,na.rm = T))%>%
arrange(desc(Total_FStudent))
library(choroplethrMaps)
##載入各國家之經緯度等資訊
data(country.map)
Country_Map <- country.map[,c(1,2,3,6,47)]
##將Total_1_2與Country_Map合併
plot_1_Info<-merge(Country_Map, Total_1_2,by="iso_a3", all.x=T)%>%
group_by(group)%>%
arrange(order)
library(RColorBrewer)
##畫面量圖
plot_1<-ggplot() +
geom_polygon(data = plot_1_Info, aes(x = long, y = lat, group = group,
fill =  Total_FStudent), color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-200, 200), ylim = c(-90, 90))+
coord_fixed()+
scale_fill_gradientn(colours = brewer.pal(7, "Reds"))+
theme_void()+
labs(fill="單位(人數)",title = "各國來台留學生面量圖")
plot_1
```
## 台灣學生國際交流分析
### 資料匯入與處理
```{r dataloadFromTWN, message=FALSE, warning=FALSE}
##匯入台灣學生到各國留學與進修的資料。
Student_RPT_07 <- read_csv("Student_RPT_07.csv", locale = locale(encoding = "BIG5"), skip = 1)
##資料整理與清洗
first_row <- Student_RPT_07[1,]
Student_RPT_07 <- Student_RPT_07[-1,]
colnames(Student_RPT_07)[c(4,5,6,12,14,15)]  <- first_row[1,c(4,5,6,12,14,15)]
Student_RPT_07 <- Student_RPT_07[complete.cases(Student_RPT_07),]
Student_RPT_07$`本國學生出國進修、交流人數` <- as.numeric(Student_RPT_07$`本國學生出國進修、交流人數`)
```
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
```{r FromTWNCountry, message=FALSE, warning=FALSE}
###選出Student_RPT_07中，台灣學生到外國進修的資料，另存成Stu_Tw_Exchange。
Stu_Tw_Exchange <- Student_RPT_07
###統計台灣學生到各國家進修的人數
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange, `對方學校(機構)國別(地區)`) %>%
summarise(Tot_Stu = sum(as.numeric(`本國學生出國進修、交流人數`))) %>%
arrange(desc(Tot_Stu))
colnames(Stu_Tw_Exchange_Concise)[1] <- "國別"
Stu_Tw_Exchange_Concise <- full_join(Stu_Tw_Exchange_Concise, Country_Name_2, by = "國別")
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[!is.na(Stu_Tw_Exchange_Concise$Tot_Stu),]
index <- Stu_Tw_Exchange_Concise$國別[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)]
library(dplyr)
Stu_Tw_Exchange_Concise <- filter(Stu_Tw_Exchange_Concise, Tot_Stu > 15)
Stu_Tw_Exchange_Concise$iso_a3[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)] <-
c("CHN","CHN","KOR","KOR","DEU","AUS","THA","ESP","SGP","NLD","CZE","AUT","RUS","SWE","PHL","BEL",
"VNM","IDN","ITA","FIN","POL","TUR","IND","DNK","LTU","NOR","IRL","KHM","EGY","SVK","HUN","MEX")
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[-7,]
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange_Concise,iso_a3)%>%
summarise(Tot_Stu = sum(Tot_Stu,na.rm = T))%>%
arrange(desc(Tot_Stu))
Stu_Tw_Exchange_Concise <- inner_join(Stu_Tw_Exchange_Concise, Country_Name_2, by="iso_a3")
Stu_Tw_Exchange_Concise_2 <- Stu_Tw_Exchange_Concise[,-c(1,4,5,6,7,8,9)]
Top_10_Stu_Tw_to_Change <- head(Stu_Tw_Exchange_Concise_2,10)
knitr::kable(Top_10_Stu_Tw_to_Change)
Sch_Stu_Abroad <- group_by(Stu_Tw_Exchange, 學校名稱)%>%
summarise(Tot_Stu = sum(as.numeric(`本國學生出國進修、交流人數`)))%>%
arrange(desc(Tot_Stu))
Top_10_Sch_Stu_Abroad <- head(Sch_Stu_Abroad,10)
knitr::kable(Top_10_Sch_Stu_Abroad)
Stu_Tw_Exchange_Concise_bar <- Stu_Tw_Exchange_Concise[,c(2,3)]
Stu_Tw_Exchange_Concise_bar$國別 <- factor(Stu_Tw_Exchange_Concise_bar$國別, levels = Stu_Tw_Exchange_Concise_bar$國別[order(desc(Stu_Tw_Exchange_Concise_bar))])
View(Stu_Tw_Exchange_Concise_bar)
Stu_Tw_Exchange_Concise_bar$國別 <- factor(Stu_Tw_Exchange_Concise_bar$國別, levels = Stu_Tw_Exchange_Concise_bar$國別[order(desc(Stu_Tw_Exchange_Concise_bar))])
Stu_Tw_Exchange_Concise_bar <- Stu_Tw_Exchange_Concise[,c(2,3)]
Stu_Tw_Exchange_Concise_bar$國別 <- factor(Stu_Tw_Exchange_Concise_bar$國別, levels = Stu_Tw_Exchange_Concise_bar$國別[order(desc(Stu_Tw_Exchange_Concise_bar))])
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise, aes(x = 國別, y = Tot_Stu),stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
View(Stu_Tw_Exchange_Concise_bar)
Stu_Tw_Exchange_Concise_bar$國別 <- factor(Stu_Tw_Exchange_Concise_bar$國別, levels = Stu_Tw_Exchange_Concise_bar$國別[order(desc(Stu_Tw_Exchange_Concise_bar$Tot_Stu))])
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise, aes(x = 國別, y = Tot_Stu),stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
Stu_Tw_Exchange_Concise_bar <- Stu_Tw_Exchange_Concise[,c(2,3)]
Stu_Tw_Exchange_Concise_bar$國別 <- factor(Stu_Tw_Exchange_Concise_bar$國別, levels = Stu_Tw_Exchange_Concise_bar$國別[order(desc(Stu_Tw_Exchange_Concise_bar$Tot_Stu))])
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise, aes(x = 國別, y = Tot_Stu),stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
Stu_Tw_Exchange_Concise_bar
---
title: "106-2 大數據分析方法 作業二"
output: github_document
author: 林辰建
---
作業完整說明[連結](https://docs.google.com/document/d/1aLGSsGXhgOVgwzSg9JdaNz2qGPQJSoupDAQownkGf_I/edit?usp=sharing)
學習再也不限定在自己出生的國家，台灣每年有許多學生選擇就讀國外的大專院校，同時也有人多國外的學生來台灣就讀，透過分析[大專校院境外學生人數統計](https://data.gov.tw/dataset/6289)、[大專校院本國學生出國進修交流數](https://data.gov.tw/dataset/24730)、[世界各主要國家之我國留學生人數統計表](https://ws.moe.edu.tw/Download.ashx?u=C099358C81D4876CC7586B178A6BD6D5062C39FB76BDE7EC7685C1A3C0846BCDD2B4F4C2FE907C3E7E96F97D24487065577A728C59D4D9A4ECDFF432EA5A114C8B01E4AFECC637696DE4DAECA03BB417&n=4E402A02CE6F0B6C1B3C7E89FDA1FAD0B5DDFA6F3DA74E2DA06AE927F09433CFBC07A1910C169A1845D8EB78BD7D60D7414F74617F2A6B71DC86D17C9DA3781394EF5794EEA7363C&icon=..csv)可以了解103年以後各大專院校國際交流的情形。請同學分析以下議題，並以視覺化的方式呈現分析結果，呈現103年以後大專院校國際交流的情形。
## 來台境外生分析
### 資料匯入與處理
```{r dataloadToTWN, message=FALSE, warning=FALSE}
library(readr)
###匯入103、104、105、106年間，外國留學生相關資訊。
###data_xxx_FStu_Country代表在民國xxx年間，各國來台留學生資訊。
###data_xxx_FStu_School代表在民國xxx年間，台灣各大專院校的外籍留學生資訊。
data_103_FStu_Country <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=25f64d5125016dcd6aed42e50c972ed0")
data_103_FStu_School <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=a6d1469f39fe41fb81dbfc373aef3331")
data_104_FStu_Country <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=4d3e9b37b7b0fd3aa18a388cdbc77996")
data_104_FStu_School <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=8baeae81cba74f35cf0bb1333d3d99f5")
data_105_FStu_Country <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=19bedf88cf46999da12513de755c33c6")
data_105_FStu_School <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=1a485383cf9995da679c3798ab4fd681")
data_106_FStu_Country <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=50e3370f9f8794f2054c0c82a2ed8c91")
data_106_FStu_School <- read_csv("https://quality.data.gov.tw/dq_download_csv.php?nid=6289&md5_url=883e2ab4d5357f70bea9ac44a47d05cc")
library(dplyr)
###將103中，各學程的外籍學生人數加總，並另存於新欄位FStudent_103。
data_103_FStu_Country <- mutate(data_103_FStu_Country, FStudent_103 = `學位生-正式修讀學位外國生`+ `學位生-僑生(含港澳)`+
`學位生-正式修讀學位陸生`+ `非學位生-外國交換生`+ `非學位生-外國短期研習及個人選讀`+ `非學位生-大專附設華語文中心學生`+
`非學位生-大陸研修生`+ `非學位生-海青班`+ 境外專班)
###將104中，各學程的外籍學生人數加總，並另存於新欄位FStudent_104。
data_104_FStu_Country <- mutate(data_104_FStu_Country, FStudent_104 = `學位生-正式修讀學位外國生`+ `學位生-僑生(含港澳)`+
`學位生-正式修讀學位陸生`+ `非學位生-外國交換生`+ `非學位生-外國短期研習及個人選讀`+ `非學位生-大專附設華語文中心學生`+
`非學位生-大陸研修生`+ `非學位生-海青班`+ 境外專班)
###將105中，各學程的外籍學生人數加總，並另存於新欄位FStudent_105。
data_105_FStu_Country <- mutate(data_105_FStu_Country, FStudent_105 = 學位生_正式修讀學位外國生+ `學位生_僑生(含港澳)`+
學位生_正式修讀學位陸生+ 非學位生_外國交換生+ 非學位生_外國短期研習及個人選讀+ 非學位生_大專附設華語文中心學生+
非學位生_大陸研修生+ 非學位生_海青班+ 境外專班)
###將106中，各學程的外籍學生人數加總，並另存於新欄位FStudent_106。
data_106_FStu_Country <- mutate(data_106_FStu_Country, FStudent_106 = 學位生_正式修讀學位外國生+ `學位生_僑生(含港澳)`+
學位生_正式修讀學位陸生+ 非學位生_外國交換生+ 非學位生_外國短期研習及個人選讀+ 非學位生_大專附設華語文中心學生+
非學位生_大陸研修生+ 非學位生_海青班+ 境外專班)
###將103、104、105、106年的資料依照'國別'合併，並另存成新的資料框Total。
Total <- full_join(data_103_FStu_Country, data_104_FStu_Country, by = '國別')
Total <- full_join(Total, data_105_FStu_Country, by = '國別')
Total <- full_join(Total, data_106_FStu_Country, by = '國別')
Total[is.na(Total)] <- as.numeric(0)
```
### 哪些國家來台灣唸書的學生最多呢？
```{r ToTWNCountry, message=FALSE, warning=FALSE}
###將Total資料框中103、104、105、106年間的留學生人數加總後另存成新欄位Total_FStudent，在依照Total_FStudent由大到小排列。
Total <- mutate(Total, Total_FStudent = FStudent_103+ FStudent_104+ FStudent_105+ FStudent_106,)%>%
arrange(desc(Total_FStudent))
###將Total資料框中，在台留學生人數少於200的國家合併，另存成"其他"，並將不需要的資訊刪除，另存於新的資料框Total_Concise。
Else <- filter(Total,Total_FStudent<200)%>%summarise(Else_Total = sum(Total_FStudent))
Total_Concise <- Total[,c(2,46)]%>%filter(Total_FStudent>= 200)%>% rbind(c("其他",Else$Else_Total))
Total_Concise$Total_FStudent <- as.numeric(Total_Concise$Total_FStudent)
TOP_10_Country <- head(Total_Concise,10)
knitr::kable(TOP_10_Country)
```
### 哪間大學的境外生最多呢？
```{r ToTWNUniversity, message=FALSE, warning=FALSE}
###資料中的"…"轉為0。
data_103_FStu_School$`非學位生-大陸研修生`[grepl("…", data_103_FStu_School$`非學位生-大陸研修生`)] <- 0
data_104_FStu_School$`非學位生-大陸研修生`[grepl("…", data_104_FStu_School$`非學位生-大陸研修生`)] <- 0
data_103_FStu_School$`非學位生-大陸研修生` <- as.numeric(data_103_FStu_School$`非學位生-大陸研修生`)
data_104_FStu_School$`非學位生-大陸研修生` <- as.numeric(data_104_FStu_School$`非學位生-大陸研修生`)
###將103中，各大專院校中，不同學程的外籍學生人數加總，並另存於新欄位FStudent_103。
data_103_FStu_School <-mutate(data_103_FStu_School, FStudent_103 = `學位生-正式修讀學位外國生`+ `學位生-僑生(含港澳)`+
`學位生-正式修讀學位陸生`+ `非學位生-外國交換生`+ `非學位生-外國短期研習及個人選讀`+ `非學位生-大專附設華語文中心學生`+
`非學位生-大陸研修生`+ `非學位生-海青班`+ 境外專班)
###將104中，各大專院校中，不同學程的外籍學生人數加總，並另存於新欄位FStudent_104。
data_104_FStu_School <- mutate(data_104_FStu_School, FStudent_104 = `學位生-正式修讀學位外國生`+ `學位生-僑生(含港澳)`+
`學位生-正式修讀學位陸生`+ `非學位生-外國交換生`+ `非學位生-外國短期研習及個人選讀`+ `非學位生-大專附設華語文中心學生`+
`非學位生-大陸研修生`+ `非學位生-海青班`+ 境外專班)
###將105中，各大專院校中，不同學程的外籍學生人數加總，並另存於新欄位FStudent_105。
data_105_FStu_School <- mutate(data_105_FStu_School, FStudent_105 = 學位生_正式修讀學位外國生+ `學位生_僑生(含港澳)`+
學位生_正式修讀學位陸生+ 非學位生_外國交換生+ 非學位生_外國短期研習及個人選讀+ 非學位生_大專附設華語文中心學生+
非學位生_大陸研修生+ 非學位生_海青班+ 境外專班)
###將106中，各大專院校中，不同學程的外籍學生人數加總，並另存於新欄位FStudent_106。
data_106_FStu_School <- mutate(data_106_FStu_School, FStudent_106 = 學位生_正式修讀學位外國生+ `學位生_僑生(含港澳)`+
學位生_正式修讀學位陸生+ 非學位生_外國交換生+ 非學位生_外國短期研習及個人選讀+ 非學位生_大專附設華語文中心學生+
非學位生_大陸研修生+ 非學位生_海青班+ 境外專班)
###將103、104、105、106年的資料依照'學校名稱'合併，並另存成新的資料框Total_2。
Total_2 <- full_join(data_103_FStu_School, data_104_FStu_School, by = '學校名稱')
Total_2 <- full_join(Total_2, data_105_FStu_School, by = '學校名稱')
Total_2 <- full_join(Total_2, data_106_FStu_School, by = '學校名稱')
Total_2[is.na(Total_2)] <- as.numeric(0)
###將Total_2資料框中103、104、105、106年間，各大專院校的的留學生人數加總後另存成新欄位Total_FStudent，在依照Total_FStudent由大到小排列。
Total_2 <- mutate(Total_2, Total_FStudent = FStudent_103+ FStudent_104+ FStudent_105+ FStudent_106)
###將Total_2資料框中，外籍留學生人數少於200的大專院校合併，另存成"其他"，並將不需要的資訊刪除，另存於新的資料框Total_Concise。
Else <- filter(Total_2,Total_FStudent<200)%>%summarise(Else_Total = sum(Total_FStudent))
Total_2_Concise <- Total_2[,c(3,50)]%>%filter(Total_FStudent>= 200)%>% rbind(c("其他",Else$Else_Total))
Total_2_Concise$Total_FStudent <- as.numeric(Total_2_Concise$Total_FStudent)
Total_2_Concise <- arrange(Total_2_Concise, desc(Total_FStudent))
TOP_10_School <- head(Total_2_Concise,10)
knitr::kable(TOP_10_School)
```
表格中，境外生最多的列為**無法區分校別**。他們為**非學位的大陸研究生**，在資料中被歸類為**無法區分校別**。
```{r ToTWNUniversity_1, message=FALSE, warning=FALSE}
Total_2_Concise_2 <- Total_2_Concise[-1,]
TOP_10_School_2 <- head(Total_2_Concise_2,10)
knitr::kable(TOP_10_School_2)
```
若忽略**無法區分校別**的部分，歷年來境外生最多的學校為**國立臺灣師範大學**
### 各個國家來台灣唸書的學生人數條狀圖
```{r ToTWNCountryBar, message=FALSE, warning=FALSE}
library(ggplot2)
Total_Concise$國別 <- factor(Total_Concise$國別, levels = Total_Concise$國別[order(desc(Total_Concise$Total_FStudent))])
ggplot()+ geom_bar(data = Total_Concise, aes(x = 國別, y = Total_FStudent), stat = "identity", width = 1, color="blue")+
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 6)) +
labs(y = "人數", title = "103到106年間各國來臺學生數量柱狀圖")
```
### 各個國家來台灣唸書的學生人數面量圖
```{r ToTWNCountryMap, message=FALSE, warning=FALSE}
###載入國含有各國國家代碼的資料。
Country_Name_2  <- read_csv("Country_Table.csv", locale = locale(encoding = "BIG5"))
colnames(Country_Name_2)[4] <- "iso_a3"
colnames(Country_Name_2)[1] <- "國別"
##將含有各國歷年來台留學生的資料(Total)與有各國國家代碼的資料合併，並另存為新的資料框Total_1_2。
Total_1_2 <- full_join(Total, Country_Name_2, by = "國別")
##將合併時遺漏的國家代碼的國家補上國家代碼。
index <- grep("[A-Z]{3}",Total_1_2$iso_a3,invert=T)
Total_1_2$iso_a3[index] <- c("VCT","KNA","TUV","MHL","XKS","SSD","MLT","COM")
##整理資料框Total_1_2
Total_1_2<-group_by(Total_1_2,iso_a3)%>%
summarise(Total_FStudent = sum(Total_FStudent,na.rm = T))%>%
arrange(desc(Total_FStudent))
library(choroplethrMaps)
##載入各國家之經緯度等資訊
data(country.map)
Country_Map <- country.map[,c(1,2,3,6,47)]
##將Total_1_2與Country_Map合併
plot_1_Info<-merge(Country_Map, Total_1_2,by="iso_a3", all.x=T)%>%
group_by(group)%>%
arrange(order)
library(RColorBrewer)
##畫面量圖
plot_1<-ggplot() +
geom_polygon(data = plot_1_Info, aes(x = long, y = lat, group = group,
fill =  Total_FStudent), color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-200, 200), ylim = c(-90, 90))+
coord_fixed()+
scale_fill_gradientn(colours = brewer.pal(7, "Reds"))+
theme_void()+
labs(fill="單位(人數)",title = "各國來台留學生面量圖")
plot_1
```
## 台灣學生國際交流分析
### 資料匯入與處理
```{r dataloadFromTWN, message=FALSE, warning=FALSE}
##匯入台灣學生到各國留學與進修的資料。
Student_RPT_07 <- read_csv("Student_RPT_07.csv", locale = locale(encoding = "BIG5"), skip = 1)
##資料整理與清洗
first_row <- Student_RPT_07[1,]
Student_RPT_07 <- Student_RPT_07[-1,]
colnames(Student_RPT_07)[c(4,5,6,12,14,15)]  <- first_row[1,c(4,5,6,12,14,15)]
Student_RPT_07 <- Student_RPT_07[complete.cases(Student_RPT_07),]
Student_RPT_07$`本國學生出國進修、交流人數` <- as.numeric(Student_RPT_07$`本國學生出國進修、交流人數`)
```
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
```{r FromTWNCountry, message=FALSE, warning=FALSE}
###選出Student_RPT_07中，台灣學生到外國進修的資料，另存成Stu_Tw_Exchange。
Stu_Tw_Exchange <- Student_RPT_07
###統計台灣學生到各國家進修的人數
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange, `對方學校(機構)國別(地區)`) %>%
summarise(Tot_Stu = sum(as.numeric(`本國學生出國進修、交流人數`))) %>%
arrange(desc(Tot_Stu))
colnames(Stu_Tw_Exchange_Concise)[1] <- "國別"
Stu_Tw_Exchange_Concise <- full_join(Stu_Tw_Exchange_Concise, Country_Name_2, by = "國別")
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[!is.na(Stu_Tw_Exchange_Concise$Tot_Stu),]
index <- Stu_Tw_Exchange_Concise$國別[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)]
library(dplyr)
Stu_Tw_Exchange_Concise <- filter(Stu_Tw_Exchange_Concise, Tot_Stu > 15)
Stu_Tw_Exchange_Concise$iso_a3[grep("[A-Z]{3}", Stu_Tw_Exchange_Concise$iso_a3, invert = T)] <-
c("CHN","CHN","KOR","KOR","DEU","AUS","THA","ESP","SGP","NLD","CZE","AUT","RUS","SWE","PHL","BEL",
"VNM","IDN","ITA","FIN","POL","TUR","IND","DNK","LTU","NOR","IRL","KHM","EGY","SVK","HUN","MEX")
Stu_Tw_Exchange_Concise <- Stu_Tw_Exchange_Concise[-7,]
Stu_Tw_Exchange_Concise <- group_by(Stu_Tw_Exchange_Concise,iso_a3)%>%
summarise(Tot_Stu = sum(Tot_Stu,na.rm = T))%>%
arrange(desc(Tot_Stu))
Stu_Tw_Exchange_Concise <- inner_join(Stu_Tw_Exchange_Concise, Country_Name_2, by="iso_a3")
Stu_Tw_Exchange_Concise_2 <- Stu_Tw_Exchange_Concise[,-c(1,4,5,6,7,8,9)]
Top_10_Stu_Tw_to_Change <- head(Stu_Tw_Exchange_Concise_2,10)
knitr::kable(Top_10_Stu_Tw_to_Change)
```
### 哪間大學的出國交流學生數最多呢？
```{r FromTWNUniversity, message=FALSE, warning=FALSE}
###統計台灣大專院校的出國交流學生人數
Sch_Stu_Abroad <- group_by(Stu_Tw_Exchange, 學校名稱)%>%
summarise(Tot_Stu = sum(as.numeric(`本國學生出國進修、交流人數`)))%>%
arrange(desc(Tot_Stu))
Top_10_Sch_Stu_Abroad <- head(Sch_Stu_Abroad,10)
knitr::kable(Top_10_Sch_Stu_Abroad)
Stu_Tw_Exchange_Concise_bar <- Stu_Tw_Exchange_Concise[,c(2,3)]
Stu_Tw_Exchange_Concise_bar$國別 <- factor(Stu_Tw_Exchange_Concise_bar$國別, levels = Stu_Tw_Exchange_Concise_bar$國別[order(desc(Stu_Tw_Exchange_Concise_bar$Tot_Stu))])
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise, aes(x = 國別, y = Tot_Stu),stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise_bar, aes(x = 國別, y = Tot_Stu),stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise_bar, aes(x = 國別, y = Tot_Stu),stat = "identity", color = "firebrick2") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise_bar, aes(x = 國別, y = Tot_Stu),stat = "identity", color = "firebrick3") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise_bar, aes(x = 國別, y = Tot_Stu),stat = "identity", color = "firebrick4") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise_bar, aes(x = 國別, y = Tot_Stu),stat = "identity", color = "firebrick3") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7))
ggplot() +
geom_bar(data = Stu_Tw_Exchange_Concise_bar, aes(x = 國別, y = Tot_Stu),stat = "identity", color = "firebrick3") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3, size = 7)) +
labs(y = "人數", title = "台灣到各國家留學人數柱狀圖")
View(Top_10_Tw_Abroad)
Top_10_Tw_Abroad <- head(Tw_Abroad ,10)[,c(2,3)]
View(Top_10_Tw_Abroad)
View(DATA3)
